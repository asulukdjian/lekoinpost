<div class="row">
  <div class="clara-upcoming-appointments col-8">
    <h2>My appointments</h2>
    <p>
      <% @my_current_appointments.each do |appointment|  %>
        <div class="card-appointment">
          <% if appointment.garden.photos.attached? %>
            <%= cl_image_tag appointment.garden.photos.first.key, class:"card-img" %>
          <% end %>
          <div class="card-appointment-infos">
            <h2><%= link_to appointment.garden.name, garden_path(appointment.garden) %></h2>
            <p>ğŸ“…  <%= appointment.date.strftime("%b %d, %Y") %>
            ğŸ•—  <%= appointment.date.strftime("%H:%M") %></p>

            <p>ğŸ§º  <%= appointment.quantity %> kg of <%= appointment.description %></p>
            <p>You will aquire <%=appointment.score %> points</p>
          
            <% if appointment.status == "accepted" %>
              <p>âœ… Appointment accepted
            <% elsif appointment.status == "refused" %>
              âŒ Appointment refused
            <% elsif appointment.status == "pending" %>
              ğŸ”„ Waiting confirmation
            <% end %>

             <% if appointment.delivered == true %>
              âœ… Delivery received
            <% elsif appointment.delivered == false %>
              âŒ Not delivered
            <% elsif appointment.delivered == nil %>
              ğŸ”„ Delivery pending </p>
            <% end %>

            <% if policy(appointment).edit? %>
              <span class="modify">ğŸ– <%= link_to "Modify", edit_appointment_path(appointment) %></span>
            <% end %>
            <% if policy(appointment).destroy? %>
              <span class="delete">ğŸ—‘ <%= link_to "delete",
                appointment_path(appointment),
                method: :delete,
                data: { confirm: "Are you sure?"
                } %></span>
            <% end %>
       <!--        <div class="card-garden-buttons">
        <div class="give-button"><#%= link_to "Give your waste", new_garden_appointment_path(@garden), class: "btn btn-primary", data:{toggle:"modal", target:"#newAppointmentModal"} %></div>
      </div> -->
            <span><%= link_to "ğŸ’¬ Chat", chatroom_path(appointment.chatroom) %></span>
          </div>
        </div>
      <% end %>
    </p>
  </div>
  <div class="clara-points col-4">
    <h2>Points</h2>
  <div class="clara-card-points">
    <% @my_booked_gardens.each do |garden| %>
      <div><h2><%= garden.name %><h2></div>
       <p><%= garden.score_for(current_user) %> / <%= garden.reward_score %>
        <% if garden.score_for(current_user) >= garden.reward_score %>
          <%= link_to "Claim your reward", claim_reward_garden_path(garden)  %> </p>
          <% end %>
        <% end %>
    </div>
  </div>
</div>
<div class="row">
  <div class="clara-past-appointments col-8">
    <h2>Past Appointments</h2>
    <% @my_past_appointments_gardens.each do |garden| %>
      <%= link_to garden.name, dashboard_path(garden_id: garden.id), class: "btn btn-primary mb-1" %>
    <% end %>
    <%= link_to 'Tous', dashboard_path, class: "btn btn-primary mb-1" %>
    <% @my_past_appointments.each do |appointment| %>
      <div class="card-appointment past">
          <% if appointment.garden.photos.attached? %>
            <%= cl_image_tag appointment.garden.photos.first.key, class:"card-img" %>
          <% end %>
          <div class="card-appointment-infos">
            <h2><%= link_to appointment.garden.name, garden_path(appointment.garden) %></h2>
            <p>ğŸ“…  <%= appointment.date.strftime("%b %d, %Y") %>
            ğŸ•—  <%= appointment.date.strftime("%H:%M") %></p>
            <p>ğŸ§º  <%= appointment.quantity %> kg of <%= appointment.description %>
            You have aquired <%=appointment.display_score_card %> points</p>
            <% if appointment.status == "accepted" %>
              <p>âœ… Appointment accepted
            <% elsif appointment.status == "refused" %>
              âŒ Appointment refused
              <% elsif appointment.status == "pending" %>
              ğŸ”„ Waiting confirmation
            <% end %>
             <% if appointment.delivered == true %>
              âœ… Delivery received
            <% elsif appointment.delivered == false %>
              âŒ Not delivered
            <% elsif appointment.delivered == nil %>
              ğŸ”„ Delivery pending </p>
            <% end %>
            <p><span><%= link_to "ğŸ’¬ Chat", chatroom_path(appointment.chatroom) %></span></p>
          </div>
        </div>
    <% end %>
  </div>
  <div class="clara-rewards col-4">
    <h2>Rewards</h2>
      <% @my_booked_gardens.each do |garden| %>
      <p><%= garden.name %></p>
       <% if garden.score_for(current_user) >= garden.reward_score %>
        <%= image_tag("Reward_image", {:style => "width:400px;"}) %>
        <% end %>
      <% end %></p>
  </div>
</div>
